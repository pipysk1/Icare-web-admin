{"version":3,"sources":["webpack:///../matrix-react-sdk/src/async-components/views/dialogs/security/ExportE2eKeysDialog.js","webpack:///../matrix-react-sdk/src/utils/MegolmExportEncryption.js"],"names":["ExportE2eKeysDialog","React","Component","constructor","props","super","ev","preventDefault","passphrase","this","_passphrase1","current","value","_passphrase2","setState","errStr","_t","_startExport","onFinished","_unmounted","createRef","state","phase","componentWillUnmount","Promise","resolve","then","matrixClient","exportRoomKeys","k","MegolmExportEncryption","JSON","stringify","f","blob","Blob","type","FileSaver","saveAs","catch","e","console","error","msg","friendlyText","render","BaseDialog","sdk","disableForm","className","title","onSubmit","_onPassphraseFormSubmit","htmlFor","ref","id","autoFocus","size","disabled","onClick","_onCancelClick","PropTypes","instanceOf","MatrixClient","isRequired","func","TextEncoder","window","TextEncodingUtf8","TextDecoder","subtleCrypto","crypto","subtle","webkitSubtle","friendlyError","Error","cryptoFailMsg","async","decryptMegolmKeyFile","data","password","body","fileStr","decode","Uint8Array","lineStart","lineEnd","indexOf","line","slice","trim","HEADER_LINE","dataStart","undefined","dataEnd","base64","latin1String","atob","uint8Array","length","i","charCodeAt","decodeBase64","unpackMegolmKeyFile","brand","SdkConfig","get","ciphertextLength","salt","subarray","iv","iterations","ciphertext","hmac","aesKey","hmacKey","deriveKeys","toVerify","isValid","plaintext","verify","name","decrypt","counter","encryptMegolmKeyFile","options","kdfRounds","kdf_rounds","getRandomValues","encodedData","encode","encrypt","cipherArray","bodyLength","resultBuffer","idx","set","toSign","sign","hmacArray","nLines","Math","ceil","lines","Array","o","encodeBase64","join","buffer","packMegolmKeyFile","start","Date","key","keybits","importKey","deriveBits","hash","now","log","aesProm","hmacProm","all","String","fromCharCode","apply","btoa"],"mappings":"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","file":"bundles/1c2834637bbf85fc5037/4.js","sourceRoot":""}